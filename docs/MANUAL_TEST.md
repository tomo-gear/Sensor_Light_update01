# 手動テストチェックリスト

ハードウェア依存のため自動テストできない動作を、実機で目視確認するためのリスト。
ファームウェア更新後に一通り確認すること。

## 前提条件

- ISP経由で最新ファームウェアを書き込み済み
- HC-SR501のHIGH期間は最短（約3秒）に設定

---

## 1. 起動・スリープ

- [x] **1-1 電源投入後スリープ**
  - 手順: 電源を入れ、動かずに待つ
  - 期待: LED_BUILTINが消灯しスリープに入る
- [x] **1-2 RGB LED初期状態**
  - 手順: 電源投入直後を観察
  - 期待: RGB LEDが消灯している

## 2. モーション検知（暗い環境）

フォトレジスタを手で覆うか、暗い部屋で実施。

- [x] **2-1 PIR検知でLED点灯**
  - 手順: センサー前で手を振る
  - 期待: RGB LEDが点灯する
- [x] **2-2 LED_BUILTIN点灯**
  - 手順: PIR検知後を観察
  - 期待: LED_BUILTINが点灯している（動作中表示）
- [x] **2-3 20秒後に消灯**
  - 手順: LED点灯後、待つ
  - 期待: 約20秒後にRGB LEDが消灯する
- [x] **2-4 消灯後スリープ復帰**
  - 手順: LED消灯後を観察
  - 期待: LED_BUILTINが消灯しスリープに入る
- [x] **2-5 消灯後に再検知**
  - 手順: LED消灯直後にセンサー前で手を振る
  - 期待: 再びRGB LEDが点灯する

## 3. モーション検知（明るい環境）

フォトレジスタに十分な光を当てて実施。

- [x] **3-1 明るいとLED非点灯**
  - 手順: 明るい環境でセンサー前で手を振る
  - 期待: LED_BUILTINは点灯、RGB LEDは点灯しない
- [x] **3-2 スリープに戻る**
  - 手順: 上記の後、待つ
  - 期待: LED_BUILTINが消灯しスリープに入る

## 4. カラーモード（エンコーダー操作）

- [x] **4-1 スリープからエンコーダーで復帰**
  - 手順: スリープ中にエンコーダーを1クリック回す
  - 期待: RGB LEDが点灯する（最初の1クリックから反応）
- [x] **4-2 時計回りで色変化**
  - 手順: エンコーダーを時計回りに回す
  - 期待: 色相が変化する（赤→黄→緑→...）
- [x] **4-3 反時計回りで色変化**
  - 手順: エンコーダーを反時計回りに回す
  - 期待: 色相が逆方向に変化する
- [x] **4-4 360°で一周**
  - 手順: 同方向に24クリック回す
  - 期待: 色が一周して元に戻る
- [x] **4-5 5秒タイムアウト**
  - 手順: 操作をやめて待つ
  - 期待: 約5秒後にLED消灯、スリープに入る

## 5. PIR再トリガー防止（EIFRフラグクリア）

- [x] **5-1 人がいてもループしない**
  - 手順: 暗い環境で、センサー前に立ち続ける。LED点灯→20秒後消灯を観察
  - 期待: 消灯後すぐに再点灯せず、スリープに入る（LED_BUILTIN消灯）
- [x] **5-2 再検知は新しい動きで**
  - 手順: 5-1の後、一度センサー範囲外に出てから戻る
  - 期待: 新しい動きでのみ再点灯する

## 6. モード間の干渉

- [x] **6-1 LED点灯中のエンコーダー**
  - 手順: PIR検知でLED点灯中にエンコーダーを回す
  - 期待: 色が変わらない（エンコーダー無効化中）
- [x] **6-2 カラーモード中のPIR**
  - 手順: エンコーダーで色変更中にセンサー前で手を振る
  - 期待: カラーモードが優先され、5秒タイムアウトまで維持
- [x] **6-3 カラー→モーション遷移**
  - 手順: カラーモードのタイムアウト後すぐにPIRを検知させる
  - 期待: 正常にモーション検知モードに入りLEDが点灯する

## 7. エンコーダーの色記憶

- [x] **7-1 色がセッション内で保持**
  - 手順: エンコーダーで青(240°)に設定→タイムアウト→PIR検知
  - 期待: 青色でLEDが点灯する
- [x] **7-2 色変更後の再エンコーダー操作**
  - 手順: 7-1の後、再度エンコーダーを回す
  - 期待: 続きの色が表示される

---

## テスト結果記録

- 2026-02-14 / 19/19 PASS / 備考
